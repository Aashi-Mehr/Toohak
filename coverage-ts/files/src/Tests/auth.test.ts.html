
  <!DOCTYPE html>
  <html>
    <head>
      <title>auth.test.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src/Tests/auth.test.ts</td><td class="">95.41%</td><td class="">80%</td><td class="">894</td><td class="">853</td><td class="">41</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import {
  Token,
  ErrorObject,
  Details,
} from &#x27;../dataStore&#x27;;

import {
  requestRegister,
  requestLogin,
  requestDetails,
  requestLogout,
  requestDetailsEdit,
  requestPasswordEdit,
  requestClear
} from &#x27;./testHelper&#x27;;

/// ////////////////////////////////////////////////////////////////////////////
/// //////////////////////////////// Tests /////////////////////////////////////
/// ////////////////////////////////////////////////////////////////////////////

// Clearing the datastore, so that the tests are independent of previous data
beforeEach(() =&gt; {
  requestClear();
});

describe(&#x27;adminAuthRegister&#x27;, () =&gt; {
  let result: Token;

  // Error checking
  test(&#x27;INVALID Password: No numbers&#x27;, () =&gt; {
    // Password must contain numbers
    result = requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;invalidpassword&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Password: No letters&#x27;, () =&gt; {
    // Password must contain letters
    result = requestRegister(&#x27;first.last2@gmail.com&#x27;, &#x27;123456789&#x27;, &#x27;first&#x27;,
      &#x27;last&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Password: Less than 8 characters&#x27;, () =&gt; {
    // Password must be greater than or equal to 8 characters
    result = requestRegister(&#x27;first.last3@gmail.com&#x27;, &#x27;acb123&#x27;, &#x27;first&#x27;,
      &#x27;last&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Name: First name contains numbers&#x27;, () =&gt; {
    // Name cannot have non-letter, non-space, non-spostrophe characters
    result = requestRegister(&#x27;first.last4@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;1nval1d first&#x27;, &#x27;last&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Name: Last name contains numbers&#x27;, () =&gt; {
    // Name cannot have non-letter, non-space, non-spostrophe characters
    result = requestRegister(&#x27;first.last5@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;first&#x27;, &#x27;1nval1d last&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Name: First name less than 2 characters&#x27;, () =&gt; {
    // Name must be between 2 and 20 characters
    result = requestRegister(&#x27;first.last6@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;a&#x27;,
      &#x27;last&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Name: Last name less than 2 characters&#x27;, () =&gt; {
    // Name must be between 2 and 20 characters
    result = requestRegister(&#x27;first.last9@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;first&#x27;, &#x27;a&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Name: First name more than 20 characters&#x27;, () =&gt; {
    // Name must be between 2 and 20 characters
    result = requestRegister(&#x27;first.last7@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;abcdefghijklmnopqrstuvwxyz&#x27;, &#x27;last&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Name: Last name more than 20 characters&#x27;, () =&gt; {
    // Name must be between 2 and 20 characters
    result = requestRegister(&#x27;first.last8@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;a&#x27;,
      &#x27;abcdefghijklmnopqrstuvwxyz&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Email: Does not satisfy validator.isEmail function&#x27;, () =&gt; {
    // Email must satisfy validator
    result = requestRegister(&#x27;first..last@email&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;INVALID Email: Used by another user&#x27;, () =&gt; {
    // Emails must be unique
    requestRegister(&#x27;first.last@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;first&#x27;,
      &#x27;last&#x27;);

    result = requestRegister(&#x27;first.last@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;firstName&#x27;, &#x27;lastName&#x27;);
    expect(result.token).toStrictEqual(-1);
  });

  test(&#x27;VALID Registration: Case 1&#x27;, () =&gt; {
    // All correct details, checking simplest case
    result = requestRegister(&#x27;first.last10@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;);
    expect(result.token).toBeGreaterThan(0);
  });

  test(&#x27;VALID Registration: Case 2&#x27;, () =&gt; {
    // All correct details, checking simplest case
    result = requestRegister(&#x27;first.last@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;);
    expect(result.token).toBeGreaterThan(0);
  });

  test(&#x27;VALID Registration: Case 3&#x27;, () =&gt; {
    // All correct details, checking simplest case
    result = requestRegister(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;firstName&#x27;, &#x27;lastName&#x27;);
    expect(result.token).toBeGreaterThan(0);
  });

  test(&#x27;VALID Registrations: Multiple Users&#x27;, () =&gt; {
    requestRegister(&#x27;first1@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    requestRegister(&#x27;first2@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    requestRegister(&#x27;first3@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    requestRegister(&#x27;first4@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);

    expect(requestLogin(&#x27;first1@gmail.com&#x27;, &#x27;Val1dPassword&#x27;)).toMatchObject({
      token: expect.any(Number)
    });
    expect(requestLogin(&#x27;first2@gmail.com&#x27;, &#x27;Val1dPassword&#x27;)).toMatchObject({
      token: expect.any(Number)
    });
    expect(requestLogin(&#x27;first3@gmail.com&#x27;, &#x27;Val1dPassword&#x27;)).toMatchObject({
      token: expect.any(Number)
    });
    expect(requestLogin(&#x27;first4@gmail.com&#x27;, &#x27;Val1dPassword&#x27;)).toMatchObject({
      token: expect.any(Number)
    });
  });
});

describe(&#x27;adminAuthLogin&#x27;, () =&gt; {
  let result: Token;

  test(&#x27;INVALID Email: Case 1&#x27;, () =&gt; {
    // Email does not exist
    result = requestLogin(&#x27;nonexisting@gmail.com&#x27;, &#x27;Val1dPassword&#x27;);
    expect(result).toMatchObject({ token: -1 });
  });

  test(&#x27;INVALID Email: Case 2&#x27;, () =&gt; {
    // Email is empty
    result = requestLogin(&#x27;&#x27;, &#x27;Val1dPassword&#x27;);
    expect(result).toMatchObject({ token: -1 });
  });

  test(&#x27;INVALID Password: Case 1&#x27;, () =&gt; {
    requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPasswoord&#x27;);
    expect(result).toMatchObject({ token: -1 });
  });

  test(&#x27;INVALID Password: Case 2&#x27;, () =&gt; {
    requestRegister(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPassword2&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPasswoord&#x27;);
    expect(result).toMatchObject({ token: -1 });
  });

  test(&#x27;INVALID Password: Case 3&#x27;, () =&gt; {
    requestRegister(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPassword3&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPasswoord&#x27;);
    expect(result).toMatchObject({ token: -1 });
  });

  test(&#x27;INVALID Password: Case 4&#x27;, () =&gt; {
    requestRegister(&#x27;first.last4@gmail.com&#x27;, &#x27;Val1dPassword4&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last4@gmail.com&#x27;, &#x27;Val1dPasswoord&#x27;);
    expect(result).toMatchObject({ token: -1 });
  });

  test(&#x27;INVALID Password: Case 5&#x27;, () =&gt; {
    requestRegister(&#x27;first.last4@gmail.com&#x27;, &#x27;Val1dPassword4&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last4@gmail.com&#x27;, &#x27;&#x27;);
    expect(result).toMatchObject({ token: -1 });
  });

  test(&#x27;VALID Details: Case 1&#x27;, () =&gt; {
    requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;);
    expect(result).toMatchObject({ token: expect.any(Number) });
  });

  test(&#x27;VALID Details: Case 2&#x27;, () =&gt; {
    requestRegister(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPassword2&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPassword2&#x27;);
    expect(result).toMatchObject({ token: expect.any(Number) });
  });

  test(&#x27;VALID Details: Case 3&#x27;, () =&gt; {
    requestRegister(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPassword3&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPassword3&#x27;);
    expect(result).toMatchObject({ token: expect.any(Number) });
  });

  test(&#x27;VALID Details: Case 4&#x27;, () =&gt; {
    requestRegister(&#x27;first.last4@gmail.com&#x27;, &#x27;Val1dPassword4&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestLogin(&#x27;first.last4@gmail.com&#x27;, &#x27;Val1dPassword4&#x27;);
    expect(result).toMatchObject({ token: expect.any(Number) });
  });
});

describe(&#x27;adminUserDetails&#x27;, () =&gt; {
  let result: Details | ErrorObject;
  let token: number;

  test(&#x27;INVALID token: Out of the possible range&#x27;, () =&gt; {
    // Tokens must be positive, non-null integers
    expect(requestDetails(0)).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID token: Incorrect ID&#x27;, () =&gt; {
    // Testing cases where the token doesn&#x27;t refer to a valid user
    token = requestRegister(&#x27;first.last@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;first&#x27;,
      &#x27;last&#x27;).token;
    result = requestDetails(token + 1);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;VALID token: Simple Case 1&#x27;, () =&gt; {
    // Valid case 1, simplest case
    token = requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;,
      &#x27;last&#x27;).token;
    result = requestDetails(token);

    expect(result).toMatchObject({
      user:
      {
        userId: expect.any(Number),
        name: &#x27;first last&#x27;,
        email: &#x27;first.last1@gmail.com&#x27;,
        numSuccessfulLogins: 1,
        numFailedPasswordsSinceLastLogin: 0,
      }
    });
  });

  test(&#x27;VALID token: Simple Case 2&#x27;, () =&gt; {
    // Valid case 2, simplest case
    token = requestRegister(&#x27;first.last2@gmail.com&#x27;,
      &#x27;Val1dPassword2&#x27;, &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestDetails(token);

    expect(result).toMatchObject({
      user:
      {
        userId: expect.any(Number),
        name: &#x27;first last&#x27;,
        email: &#x27;first.last2@gmail.com&#x27;,
        numSuccessfulLogins: 1,
        numFailedPasswordsSinceLastLogin: 0,
      }
    });
  });

  test(&#x27;VALID token: Simple Case 3&#x27;, () =&gt; {
    // Valid case 3, simplest case
    token = requestRegister(&#x27;first.last3@gmail.com&#x27;,
      &#x27;Val1dPassword3&#x27;, &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestDetails(token);

    expect(result).toMatchObject({
      user:
      {
        userId: expect.any(Number),
        name: &#x27;first last&#x27;,
        email: &#x27;first.last3@gmail.com&#x27;,
        numSuccessfulLogins: 1,
        numFailedPasswordsSinceLastLogin: 0,
      }
    });
  });

  test(&#x27;VALID token: Simple Case 4&#x27;, () =&gt; {
    // Valid case 4, simplest case
    token = requestRegister(&#x27;first.last4@gmail.com&#x27;,
      &#x27;Val1dPassword4&#x27;, &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestDetails(token);

    expect(result).toMatchObject({
      user:
      {
        userId: expect.any(Number),
        name: &#x27;first last&#x27;,
        email: &#x27;first.last4@gmail.com&#x27;,
        numSuccessfulLogins: 1,
        numFailedPasswordsSinceLastLogin: 0,
      }
    });
  });

  test(&#x27;VALID token: Complex Case 1&#x27;, () =&gt; {
    // Valid case logging in, then details must show valid logins increased
    requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    token = requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;).token;

    result = requestDetails(token);
    expect(result).toMatchObject({
      user:
      {
        userId: expect.any(Number),
        name: &#x27;first last&#x27;,
        email: &#x27;first.last1@gmail.com&#x27;,
        numSuccessfulLogins: 2,
        numFailedPasswordsSinceLastLogin: 0,
      }
    });
  });

  test(&#x27;VALID token: Complex Case 2&#x27;, () =&gt; {
    // Valid case, failed login attempts must increase
    requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    token = requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;).token;
    requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;INVal1dPassword1&#x27;);

    result = requestDetails(token);
    expect(result).toMatchObject({
      user:
      {
        userId: expect.any(Number),
        name: &#x27;first last&#x27;,
        email: &#x27;first.last1@gmail.com&#x27;,
        numSuccessfulLogins: 2,
        numFailedPasswordsSinceLastLogin: 1,
      }
    });
  });

  test(&#x27;VALID token: Complex Case 3&#x27;, () =&gt; {
    // Adding more logins
    requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    token = requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;).token;
    requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;INVal1dPassword1&#x27;);
    requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;INVal1dPassword1&#x27;);

    result = requestDetails(token);
    expect(result).toMatchObject({
      user:
      {
        userId: expect.any(Number),
        name: &#x27;first last&#x27;,
        email: &#x27;first.last1@gmail.com&#x27;,
        numSuccessfulLogins: 2,
        numFailedPasswordsSinceLastLogin: 2,
      }
    });
  });

  test(&#x27;VALID token: Complex Case 4&#x27;, () =&gt; {
    // Adding a mixture of logins and failed logins
    // Failed logins should reset after a successful login
    requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;);
    requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;INVal1dPassword1&#x27;);
    requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;INVal1dPassword1&#x27;);
    token = requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;).token;

    result = requestDetails(token);
    expect(result).toMatchObject({
      user:
      {
        userId: expect.any(Number),
        name: &#x27;first last&#x27;,
        email: &#x27;first.last1@gmail.com&#x27;,
        numSuccessfulLogins: 3,
        numFailedPasswordsSinceLastLogin: 0,
      }
    });
  });
});

describe(&#x27;adminAuthLogout&#x27;, () =&gt; {
  let result: ErrorObject | Record&lt;string, never&gt;;
  let token: number;

  test(&#x27;INVALID Token: Doesn\&#x27;t Exist&#x27;, () =&gt; {
    // Logging out a token that doesn&#x27;t exist
    token = requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;invalidpassword&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestLogout(token + 1);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Token: Outside valid range&#x27;, () =&gt; {
    // Logging out a token that&#x27;s outside the valid range
    result = requestLogout(0);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Token: Already Logged Out&#x27;, () =&gt; {
    // Logging out an invalid token
    token = requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;).token;
    requestLogout(token);
    result = requestLogout(token);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;VALID Token: Simple Case 1&#x27;, () =&gt; {
    // Testing the simplest valid case
    token = requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestLogout(token);
    expect(Object.keys(result).length).toStrictEqual(0);

    const info = requestDetails(token);
    expect(info).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;VALID Token: Simple Case 2&#x27;, () =&gt; {
    // Testing the simplest valid case
    token = requestRegister(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPassword2&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestLogout(token);
    expect(Object.keys(result).length).toStrictEqual(0);

    const info = requestDetails(token);
    expect(info).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;VALID Token: Simple Case 3&#x27;, () =&gt; {
    // Testing the simplest valid case
    token = requestRegister(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPassword3&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestLogout(token);
    expect(Object.keys(result).length).toStrictEqual(0);

    const info = requestDetails(token);
    expect(info).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;VALID Token: Complex Case 1&#x27;, () =&gt; {
    // Testing logout of a second session
    requestRegister(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    token = requestLogin(&#x27;first.last1@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;).token;
    result = requestLogout(token);
    expect(Object.keys(result).length).toStrictEqual(0);
  });

  test(&#x27;VALID Token: Complex Case 2&#x27;, () =&gt; {
    // Testing logout of initial login session
    token = requestRegister(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPassword2&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;).token;
    requestLogin(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPassword2&#x27;);
    result = requestLogout(token);
    expect(Object.keys(result).length).toStrictEqual(0);
  });

  test(&#x27;VALID Token: Complex Case 3&#x27;, () =&gt; {
    // Testing multiple sessions
    token = requestRegister(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPassword3&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;).token;
    requestLogout(token);
    requestLogin(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPassword3&#x27;);
    requestLogin(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPassword3&#x27;);
    token = requestLogin(&#x27;first.last3@gmail.com&#x27;, &#x27;Val1dPassword3&#x27;).token;
    result = requestLogout(token);
    expect(Object.keys(result).length).toStrictEqual(0);
  });
});

describe(&#x27;adminUserDetailsEdit&#x27;, () =&gt; {
  let result: Record&lt;string, never&gt; | ErrorObject;
  let token: number;

  beforeEach(() =&gt; {
    token = requestRegister(&#x27;first.last@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;first&#x27;,
      &#x27;last&#x27;).token;
  });

  test(&#x27;INVALID token: Out of the possible range&#x27;, () =&gt; {
    result = requestDetailsEdit(0, &#x27;hayden.smith@unsw.edu.au&#x27;, &#x27;Hayden&#x27;,
      &#x27;Smith&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID token: Incorrect ID&#x27;, () =&gt; {
    result = requestDetailsEdit(token + 1, &#x27;hayden.smith@unsw.edu.au&#x27;, &#x27;Hayden&#x27;,
      &#x27;Smith&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Name: First name contains numbers&#x27;, () =&gt; {
    result = requestDetailsEdit(token, &#x27;first.last4@gmail.com&#x27;, &#x27;1nval1d first&#x27;,
      &#x27;last&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Name: Last name contains numbers&#x27;, () =&gt; {
    result = requestDetailsEdit(token, &#x27;first.last5@gmail.com&#x27;, &#x27;first&#x27;,
      &#x27;1nval1d last&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Name: First name less than 2 characters&#x27;, () =&gt; {
    result = requestDetailsEdit(token, &#x27;first.last6@gmail.com&#x27;, &#x27;a&#x27;, &#x27;last&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Name: Last name less than 2 characters&#x27;, () =&gt; {
    result = requestDetailsEdit(token, &#x27;first.last9@gmail.com&#x27;, &#x27;first&#x27;, &#x27;a&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Name: First name more than 20 characters&#x27;, () =&gt; {
    result = requestDetailsEdit(token, &#x27;first.last7@gmail.com&#x27;,
      &#x27;abcdefghijklmnopqrstuvwxyz&#x27;, &#x27;last&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Name: Last name more than 20 characters&#x27;, () =&gt; {
    result = requestDetailsEdit(token, &#x27;first.last8@gmail.com&#x27;, &#x27;a&#x27;,
      &#x27;abcdefghijklmnopqrstuvwxyz&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Email: Does not satisfy validator.isEmail function&#x27;, () =&gt; {
    result = requestDetailsEdit(token, &#x27;first..last@email&#x27;,
      &#x27;first&#x27;, &#x27;last&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID details: Email already exists&#x27;, () =&gt; {
    requestRegister(&#x27;first.last2@gmail.com&#x27;, &#x27;Val1dPassword1&#x27;, &#x27;first&#x27;, &#x27;last&#x27;);
    result = requestDetailsEdit(token, &#x27;first.last2@gmail.com&#x27;, &#x27;firs&#x27;, &#x27;last&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;VALID token: Simple Case 1&#x27;, () =&gt; {
    result = requestDetailsEdit(token, &#x27;hayden.smith@unsw.edu.au&#x27;, &#x27;Hayden&#x27;,
      &#x27;Smith&#x27;);
    expect(Object.keys(result).length).toStrictEqual(0);
  });

  test(&#x27;VALID token: Simple Case 2&#x27;, () =&gt; {
    token = requestRegister(&#x27;first.last2@gmail.com&#x27;,
      &#x27;Val1dPassword2&#x27;, &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestDetailsEdit(token, &#x27;hayden.smith@unsw.edu.au&#x27;, &#x27;Hayden&#x27;,
      &#x27;Smith&#x27;);

    expect(Object.keys(result).length).toStrictEqual(0);
  });

  test(&#x27;VALID token: Simple Case 3&#x27;, () =&gt; {
    token = requestRegister(&#x27;first.last3@gmail.com&#x27;,
      &#x27;Val1dPassword3&#x27;, &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestDetailsEdit(token, &#x27;hayden.smith@unsw.edu.au&#x27;, &#x27;Hayden&#x27;,
      &#x27;Smith&#x27;);

    expect(Object.keys(result).length).toStrictEqual(0);
  });

  test(&#x27;VALID token: Simple Case 4&#x27;, () =&gt; {
    token = requestRegister(&#x27;first.last4@gmail.com&#x27;,
      &#x27;Val1dPassword4&#x27;, &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestDetailsEdit(token, &#x27;hayden.smith@unsw.edu.au&#x27;, &#x27;Hayden&#x27;,
      &#x27;Smith&#x27;);

    expect(Object.keys(result).length).toStrictEqual(0);
  });
});

describe(&#x27;adminUserPasswordEdit&#x27;, () =&gt; {
  let result: Record&lt;string, never&gt; | ErrorObject;
  let token: number;

  beforeEach(() =&gt; {
    token = requestRegister(&#x27;first.last@gmail.com&#x27;, &#x27;Val1dPassword&#x27;, &#x27;first&#x27;,
      &#x27;last&#x27;).token;
  });

  test(&#x27;INVALID token: Out of the possible range&#x27;, () =&gt; {
    result = requestPasswordEdit(0, &#x27;Val1dPassword&#x27;, &#x27;NewVal1dPassword&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID token: Incorrect ID&#x27;, () =&gt; {
    result = requestPasswordEdit(token + 1, &#x27;Val1dPassword&#x27;, &#x27;NewVal1dPass&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Password: No numbers&#x27;, () =&gt; {
    result = requestPasswordEdit(token, &#x27;Val1dPassword&#x27;, &#x27;newpassword&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Password: No letters&#x27;, () =&gt; {
    result = requestPasswordEdit(token, &#x27;Val1dPassword&#x27;, &#x27;1234567890&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Password: Less than 8 characters&#x27;, () =&gt; {
    result = requestPasswordEdit(token, &#x27;Val1dPassword&#x27;, &#x27;newpass&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Password: Not changed&#x27;, () =&gt; {
    requestPasswordEdit(token, &#x27;Val1dPassword&#x27;, &#x27;NewVal1dPass&#x27;);
    result = requestPasswordEdit(token, &#x27;NewVal1dPass&#x27;, &#x27;Val1dPassword&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;INVALID Password: Used before&#x27;, () =&gt; {
    requestPasswordEdit(token, &#x27;Val1dPassword&#x27;, &#x27;newpass123&#x27;);
    requestPasswordEdit(token, &#x27;newpass123&#x27;, &#x27;newnewpass123&#x27;);
    result = requestPasswordEdit(token, &#x27;newnewpass123&#x27;, &#x27;Val1dPassword&#x27;);
    expect(result).toMatchObject({ error: expect.any(String) });
  });

  test(&#x27;VALID token: Simple Case 1&#x27;, () =&gt; {
    result = requestPasswordEdit(token, &#x27;Val1dPassword&#x27;, &#x27;NewVal1dPass&#x27;);
    expect(Object.keys(result).length).toStrictEqual(0);
  });

  test(&#x27;VALID token: Simple Case 2&#x27;, () =&gt; {
    token = requestRegister(&#x27;first.last2@gmail.com&#x27;,
      &#x27;Val1dPassword2&#x27;, &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestPasswordEdit(token, &#x27;Val1dPassword2&#x27;, &#x27;NEWVal1dPassword2&#x27;);
    expect(Object.keys(result).length).toStrictEqual(0);
  });

  test(&#x27;VALID token: Simple Case 3&#x27;, () =&gt; {
    token = requestRegister(&#x27;first.last2@gmail.com&#x27;,
      &#x27;Val1dPassword2&#x27;, &#x27;first&#x27;, &#x27;last&#x27;).token;
    result = requestPasswordEdit(token, &#x27;Val1dPassword2&#x27;, &#x27;Val1dPassword&#x27;);
    expect(Object.keys(result).length).toStrictEqual(0);
  });
});
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:137,&quot;character&quot;:6,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:140,&quot;character&quot;:6,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:143,&quot;character&quot;:6,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:146,&quot;character&quot;:6,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:199,&quot;character&quot;:35,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:205,&quot;character&quot;:35,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:211,&quot;character&quot;:35,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:217,&quot;character&quot;:35,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:227,&quot;character&quot;:46,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:235,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:247,&quot;character&quot;:8,&quot;text&quot;:&quot;userId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:265,&quot;character&quot;:8,&quot;text&quot;:&quot;userId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:283,&quot;character&quot;:8,&quot;text&quot;:&quot;userId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:301,&quot;character&quot;:8,&quot;text&quot;:&quot;userId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:319,&quot;character&quot;:8,&quot;text&quot;:&quot;userId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:338,&quot;character&quot;:8,&quot;text&quot;:&quot;userId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:358,&quot;character&quot;:8,&quot;text&quot;:&quot;userId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:380,&quot;character&quot;:8,&quot;text&quot;:&quot;userId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:399,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:405,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:414,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:425,&quot;character&quot;:33,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:436,&quot;character&quot;:33,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:447,&quot;character&quot;:33,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:492,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:498,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:504,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:510,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:515,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:520,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:526,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:532,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:538,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:544,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:592,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:597,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:602,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:607,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:612,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:618,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/Tests/auth.test.ts&quot;,&quot;line&quot;:625,&quot;character&quot;:35,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Wed, 01 Nov 2023 00:14:18 GMT</p>
    </body>
  </html>
  